{"ast":null,"code":"import BaseFormTextField from '@/components/BaseFormTextField.vue';\nimport BaseFormTextarea from '@/components/BaseFormTextarea.vue';\nimport BaseFormRadioDelivery from '@/components/BaseFormRadioDelivery.vue';\nimport BaseFormRadioPayment from '@/components/BaseFormRadioPayment.vue';\nexport default {\n  components: {\n    BaseFormTextField,\n    BaseFormTextarea,\n    BaseFormRadioDelivery,\n    BaseFormRadioPayment\n  },\n\n  data() {\n    return {\n      formData: {\n        name: null,\n        address: null,\n        phone: null,\n        email: null,\n        comments: null,\n        paymentId: 1,\n        deliveryId: 1\n      }\n    };\n  },\n\n  computed: {\n    cart() {\n      return this.$store.state.cartProductsData;\n    },\n\n    totalPrice() {\n      return this.$store.getters.cartTotalPrice + this.deliveryPrice;\n    },\n\n    totalQuantity() {\n      return this.$store.getters.cartTotalQuantity;\n    },\n\n    payments() {\n      return this.$store.state.paymentsData;\n    },\n\n    deliveries() {\n      return this.$store.state.deliveriesData;\n    },\n\n    deliveryPrice() {\n      return this.deliveries ? +this.deliveries.find(delivery => delivery.id === this.formData.deliveryId).price : 0;\n    },\n\n    formError() {\n      return this.$store.state.orderErrorInfo || {};\n    },\n\n    formErrorMessage() {\n      return this.$store.state.formErrorMessage;\n    },\n\n    orderErrorMessage() {\n      return this.$store.state.orderErrorMessage;\n    },\n\n    isSending() {\n      return this.$store.state.isSending;\n    },\n\n    isSendingFailed() {\n      return this.$store.state.isSendingFailed;\n    },\n\n    isLoading() {\n      return this.$store.state.isLoading;\n    },\n\n    isLoadingFailed() {\n      return this.$store.state.isLoadingFailed;\n    }\n\n  },\n  methods: {\n    sendOrder() {\n      this.$store.dispatch('sendOrder', {\n        name: this.formData.name,\n        address: this.formData.address,\n        phone: this.formData.phone,\n        email: this.formData.email,\n        deliveryTypeId: this.formData.deliveryId,\n        paymentTypeId: this.formData.paymentId,\n        comments: this.formData.comments\n      });\n    },\n\n    loadPayments() {\n      this.$store.dispatch('loadPayments', {\n        deliveryTypeId: this.formData.deliveryId\n      });\n    }\n\n  },\n  watch: {\n    'formData.deliveryId'() {\n      this.loadPayments();\n      this.formData.paymentId = null;\n    }\n\n  },\n\n  created() {\n    this.$store.dispatch('loadDeliveries');\n    this.loadPayments();\n  }\n\n};","map":{"version":3,"mappings":"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","names":["BaseFormTextField","BaseFormTextarea","BaseFormRadioDelivery","BaseFormRadioPayment","components","data","formData","name","address","phone","email","comments","paymentId","deliveryId","computed","cart","$store","state","cartProductsData","totalPrice","getters","cartTotalPrice","deliveryPrice","totalQuantity","cartTotalQuantity","payments","paymentsData","deliveries","deliveriesData","find","delivery","id","price","formError","orderErrorInfo","formErrorMessage","orderErrorMessage","isSending","isSendingFailed","isLoading","isLoadingFailed","methods","sendOrder","dispatch","deliveryTypeId","paymentTypeId","loadPayments","watch","created"],"sourceRoot":"","sources":["D:\\задание\\final_examination_vue.js_dpo\\project\\mue\\src\\pages\\OrderPage.vue"],"sourcesContent":["<template>\r\n  <main class=\"content container\">\r\n    <div class=\"content__top\">\r\n      <ul class=\"breadcrumbs\">\r\n        <li class=\"breadcrumbs__item\">\r\n          <router-link class=\"breadcrumbs__link\" :to=\"{ name: 'main' }\">\r\n            Каталог\r\n          </router-link>\r\n        </li>\r\n        <li class=\"breadcrumbs__item\">\r\n          <router-link class=\"breadcrumbs__link\" :to=\"{ name: 'cart' }\">\r\n            Корзина\r\n          </router-link>\r\n        </li>\r\n        <li class=\"breadcrumbs__item\">\r\n          <a class=\"breadcrumbs__link\">\r\n            Оформление заказа\r\n          </a>\r\n        </li>\r\n      </ul>\r\n\r\n      <div class=\"content__row\">\r\n        <h1 class=\"content__title\">\r\n          Оформление заказа\r\n        </h1>\r\n      </div>\r\n    </div>\r\n\r\n    <section class=\"cart\">\r\n      <form class=\"cart__form form\" action=\"#\" method=\"POST\" @submit.prevent=\"sendOrder\">\r\n        <div class=\"loader-wrapper\" v-if=\"isSending\">\r\n          <base-loader></base-loader>\r\n        </div>\r\n        <div class=\"cart__field\" v-else>\r\n          <div class=\"cart__data\">\r\n            <base-form-text-field title=\"ФИО\" placeholder=\"Введите ваше имя\" :error=\"formError.name\" v-model=\"formData.name\"></base-form-text-field>\r\n\r\n            <base-form-text-field title=\"Адрес доставки\" placeholder=\"Введите ваш адрес\" :error=\"formError.address\" v-model=\"formData.address\"></base-form-text-field>\r\n\r\n            <base-form-text-field title=\"Телефон\" placeholder=\"Введите ваш телефон\" :error=\"formError.phone\" v-model=\"formData.phone\"></base-form-text-field>\r\n\r\n            <base-form-text-field title=\"Email\" placeholder=\"Введите ваш Email\" :error=\"formError.email\" v-model=\"formData.email\"></base-form-text-field>\r\n\r\n            <base-form-textarea title=\"Комментарии к заказу\" placeholder=\"Ваши пожелания\" :error=\"formError.comments\" v-model=\"formData.comments\"></base-form-textarea>\r\n          </div>\r\n\r\n          <div class=\"cart__options\" v-if=\"isLoading\">\r\n            <div class=\"loader-wrapper\">\r\n              <base-loader></base-loader>\r\n            </div>\r\n          </div>\r\n          <div class=\"cart__options\" v-else-if=\"isLoadingFailed\">\r\n            <h2>Возникла ошибка при загрузке товаров. Попробуйте позже.</h2>\r\n          </div>\r\n          <div class=\"cart__options\" v-else>\r\n            <h3 class=\"cart__title\">Доставка</h3>\r\n            <ul class=\"cart__options options\">\r\n              <base-form-radio-delivery v-for=\"delivery in deliveries\" :key=\"delivery.id\" group=\"delivery\" :value=\"delivery.id\" :title=\"delivery.title\" :price=\"delivery.price\" v-model=\"formData.deliveryId\"></base-form-radio-delivery>\r\n            </ul>\r\n            <span class=\"form__error\" v-if=\"formError.deliveryTypeId\">{{ formError.deliveryTypeId }}</span>\r\n\r\n            <h3 class=\"cart__title\">Оплата</h3>\r\n            <ul class=\"cart__options options\">\r\n              <base-form-radio-payment v-for=\"payment in payments\" :key=\"payment.id\" group=\"pay\" :title=\"payment.title\" :value=\"payment.id\" v-model=\"formData.paymentId\"></base-form-radio-payment>\r\n            </ul>\r\n            <span class=\"form__error\" v-if=\"formError.paymentTypeId\">{{ formError.paymentTypeId }}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"cart__block\">\r\n          <ul class=\"cart__orders\">\r\n            <li class=\"cart__order\" v-for=\"item in cart\" :key=\"item.id\">\r\n              <h3>{{ item.product.title }}</h3>\r\n              <b>{{ item.product.price }} ₽</b>\r\n              <h3>\r\n                Размер: {{ item.size.title }}\r\n              </h3>\r\n              <span>\r\n                Артикул: {{ item.product.id }}\r\n            </span>\r\n            </li>\r\n          </ul>\r\n          \r\n          <div class=\"cart__total\">\r\n            <p>Доставка: <b>{{ deliveryPrice ? `${ deliveryPrice } ₽` : 'бесплатно' }}</b></p>\r\n            <p>Итого: <b>{{ totalQuantity }}</b> товара на сумму <b>{{ totalPrice }} ₽</b></p>\r\n          </div>\r\n\r\n          <button class=\"cart__button button button--primery\" type=\"submit\" :disabled=\"isLoading || isLoadingFailed\">\r\n            Оформить заказ\r\n          </button>\r\n        </div>\r\n        <div class=\"cart__error form__error-block\" v-if=\"orderErrorMessage\">\r\n          <h4>Заявка не отправлена!</h4>\r\n          <p>\r\n            {{ orderErrorMessage || 'Похоже произошла ошибка. Попробуйте отправить снова или перезагрузите страницу.' }}\r\n          </p>\r\n        </div>\r\n      </form>\r\n    </section>\r\n  </main>\r\n</template>\r\n\r\n<script>\r\nimport BaseFormTextField from '@/components/BaseFormTextField.vue';\r\nimport BaseFormTextarea from '@/components/BaseFormTextarea.vue';\r\nimport BaseFormRadioDelivery from '@/components/BaseFormRadioDelivery.vue';\r\nimport BaseFormRadioPayment from '@/components/BaseFormRadioPayment.vue';\r\n\r\nexport default {\r\n  components: { BaseFormTextField, BaseFormTextarea, BaseFormRadioDelivery, BaseFormRadioPayment },\r\n  data() {\r\n    return {\r\n      formData: {\r\n        name: null,\r\n        address: null,\r\n        phone: null,\r\n        email: null,\r\n        comments: null,\r\n        paymentId: 1,\r\n        deliveryId: 1,\r\n      },\r\n    }\r\n  },\r\n  computed: {\r\n    cart() {\r\n      return this.$store.state.cartProductsData;\r\n    },\r\n    totalPrice() {\r\n      return this.$store.getters.cartTotalPrice + this.deliveryPrice;\r\n    },\r\n    totalQuantity() {\r\n      return this.$store.getters.cartTotalQuantity;\r\n    },\r\n    payments() {\r\n      return this.$store.state.paymentsData;\r\n    },\r\n    deliveries() {\r\n      return this.$store.state.deliveriesData;\r\n    },\r\n    deliveryPrice() {\r\n      return this.deliveries ? +this.deliveries.find(delivery => delivery.id === this.formData.deliveryId).price : 0;\r\n    },\r\n    formError() {\r\n      return this.$store.state.orderErrorInfo || {};\r\n    },\r\n    formErrorMessage() {\r\n      return this.$store.state.formErrorMessage;\r\n    },\r\n    orderErrorMessage() {\r\n      return this.$store.state.orderErrorMessage;\r\n    },\r\n    isSending() {\r\n      return this.$store.state.isSending;\r\n    },\r\n    isSendingFailed() {\r\n      return this.$store.state.isSendingFailed;\r\n    },\r\n    isLoading() {\r\n      return this.$store.state.isLoading;\r\n    },\r\n    isLoadingFailed() {\r\n      return this.$store.state.isLoadingFailed;\r\n    },\r\n  },\r\n  methods: {\r\n    sendOrder() {\r\n      this.$store.dispatch('sendOrder', {\r\n        name: this.formData.name,\r\n        address: this.formData.address,\r\n        phone: this.formData.phone,\r\n        email: this.formData.email,\r\n        deliveryTypeId: this.formData.deliveryId,\r\n        paymentTypeId: this.formData.paymentId,\r\n        comments: this.formData.comments\r\n      });\r\n    },\r\n    loadPayments() {\r\n      this.$store.dispatch('loadPayments', { deliveryTypeId: this.formData.deliveryId });\r\n    }\r\n  },\r\n  watch: {\r\n    'formData.deliveryId'() {\r\n      this.loadPayments();\r\n      this.formData.paymentId = null;\r\n    }\r\n  },\r\n  created() {\r\n    this.$store.dispatch('loadDeliveries');\r\n    this.loadPayments();\r\n  }\r\n}\r\n</script>"]},"metadata":{},"sourceType":"module"}