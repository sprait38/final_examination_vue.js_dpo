{"ast":null,"code":"import axios from 'axios';\nimport { API_URL } from '@/config.js';\nimport BaseItemCounter from '@/components/BaseItemCounter.vue';\nimport BaseItemContent from '@/components/BaseItemContent.vue';\nimport BaseItemDelivery from '@/components/BaseItemDelivery.vue';\nexport default {\n  components: {\n    BaseItemCounter,\n    BaseItemContent,\n    BaseItemDelivery\n  },\n\n  data() {\n    return {\n      productAmount: 1,\n      isLoading: false,\n      isLoadingFailed: false,\n      isSending: false,\n      isSendingFailed: false,\n      isAdded: false,\n      productData: null,\n      activeColorIdx: 0,\n      activeSizeIdx: 0,\n      selectedTab: 'base-item-content'\n    };\n  },\n\n  computed: {\n    product() {\n      return { ...this.productData,\n        gallery: this.productData.colors.map(color => {\n          return {\n            id: color.color.id,\n            image: color.gallery ? color.gallery[0].file.url : 'https://westsiderc.org/wp-content/uploads/2019/08/Image-Not-Available.png'\n          };\n        })\n      };\n    },\n\n    gallery() {\n      return this.product.gallery;\n    },\n\n    activeColorId: {\n      get() {\n        return this.gallery[this.activeColorIdx].id;\n      },\n\n      set(id) {\n        const idx = this.gallery.findIndex(item => item.id === id);\n        this.activeColorIdx = idx;\n      }\n\n    },\n    activeSizeId: {\n      get() {\n        return this.product.sizes[this.activeSizeIdx].id;\n      },\n\n      set(id) {\n        const idx = this.product.sizes.findIndex(item => item.id === id);\n        this.activeSizeIdx = idx;\n      }\n\n    }\n  },\n  methods: {\n    async loadProduct() {\n      this.isLoading = true;\n      this.isLoadingFailed = false;\n\n      try {\n        const {\n          data\n        } = await axios.get(`${API_URL}/products/${this.$route.params.id}`);\n        console.log(data);\n        this.productData = data;\n      } catch (err) {\n        this.isLoading = false;\n        this.isLoadingFailed = true;\n      }\n\n      this.isLoading = false;\n    },\n\n    setItemAmount(val) {\n      this.productAmount = val;\n    },\n\n    changeImg(id) {\n      const idx = this.gallery.findIndex(item => item.id === id);\n      this.activeColorIdx = idx;\n    },\n\n    async addToCart() {\n      this.isSending = true;\n      this.isAdded = false;\n      this.isSendingFailed = false;\n\n      try {\n        await this.$store.dispatch('addToCart', {\n          productId: this.product.id,\n          colorId: this.activeColorId,\n          sizeId: this.activeSizeId,\n          quantity: this.productAmount\n        });\n      } catch (err) {\n        this.isSendingFailed = true;\n      }\n\n      this.isSending = false;\n      this.isAdded = true;\n    },\n\n    setSelectedComponent(val) {\n      this.selectedTab = val;\n    }\n\n  },\n\n  created() {\n    this.loadProduct();\n  }\n\n};","map":{"version":3,"mappings":"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","names":["axios","API_URL","BaseItemCounter","BaseItemContent","BaseItemDelivery","components","data","productAmount","isLoading","isLoadingFailed","isSending","isSendingFailed","isAdded","productData","activeColorIdx","activeSizeIdx","selectedTab","computed","product","gallery","colors","map","color","id","image","file","url","activeColorId","get","set","idx","findIndex","item","activeSizeId","sizes","methods","loadProduct","$route","params","console","log","err","setItemAmount","val","changeImg","addToCart","$store","dispatch","productId","colorId","sizeId","quantity","setSelectedComponent","created"],"sourceRoot":"","sources":["D:\\задание\\final_examination_vue.js_dpo\\project\\mue\\src\\pages\\ProductPage.vue"],"sourcesContent":["<template>\r\n  <main class=\"content container\" v-if=\"isLoading\">\r\n    <div class=\"loader-wrapper\">\r\n      <base-loader></base-loader>\r\n    </div>\r\n  </main>\r\n  <main class=\"content container\" v-else-if=\"isLoadingFailed\">\r\n    <h1>Проиошла ошибка при загрузке товара. Пожалуйста, попробуйте зайти сюда позже.</h1>\r\n  </main>\r\n  <main class=\"content container\" v-else>\r\n    <div class=\"content__top\">\r\n      <ul class=\"breadcrumbs\">\r\n        <li class=\"breadcrumbs__item\">\r\n          <router-link class=\"breadcrumbs__link\" :to=\"{ name: 'main' }\">\r\n            Каталог\r\n          </router-link>\r\n        </li>\r\n        <li class=\"breadcrumbs__item\">\r\n          <router-link class=\"breadcrumbs__link\" :to=\"{ name: 'main', query: { 'categoryId': product.category.id } }\">\r\n            {{ product.category.title }}\r\n          </router-link>\r\n        </li>\r\n        <li class=\"breadcrumbs__item\">\r\n          <a class=\"breadcrumbs__link\">\r\n            {{ product.title }}\r\n          </a>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <section class=\"item\">\r\n      <div class=\"item__pics pics\">\r\n        <div class=\"pics__wrapper\">\r\n          <img width=\"570\" height=\"570\" :src=\"gallery[activeColorIdx].image\" :alt=\"product.title\">\r\n        </div>\r\n        <ul class=\"pics__list\">\r\n          <li class=\"pics__item\" v-for=\"image in gallery\" :key=\"image.id\">\r\n            <a href=\"\" class=\"pics__link\" :class=\"{ 'pics__link--current': image.id === activeColorId }\" @click.prevent=\"changeImg(image.id)\">\r\n              <img width=\"98\" height=\"98\" :src=\"image.image\" :alt=\"product.title\">\r\n            </a>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n\r\n      <div class=\"item__info\">\r\n        <span class=\"item__code\">Артикул: {{ product.id }}</span>\r\n        <h2 class=\"item__title\">\r\n          {{ product.title }}\r\n        </h2>\r\n        <div class=\"item__form\">\r\n          <form class=\"form\" action=\"#\" method=\"POST\">\r\n            <div class=\"item__row item__row--center\">\r\n              <base-item-counter v-model=\"productAmount\" :itemAmount=\"productAmount\" @change-item-amount=\"setItemAmount\"></base-item-counter>\r\n              \r\n              <b class=\"item__price\">\r\n                {{ product.price }} ₽\r\n              </b>\r\n            </div>\r\n\r\n            <div class=\"item__row\">\r\n              <fieldset class=\"form__block\">\r\n                <legend class=\"form__legend\">Цвет</legend>\r\n                <ul class=\"colors colors--black\">\r\n                  <li class=\"colors__item\" v-for=\"color in product.colors\" :key=\"color.id\">\r\n                    <label class=\"colors__label\">\r\n                      <input class=\"colors__radio sr-only\" type=\"radio\" name=\"color\" :value=\"color.color.id\" :checked=\"activeColorId === color.color.id\" v-model=\"activeColorId\">\r\n                      <span class=\"colors__value\" :style=\"{ 'background-color': color.color.code}\">\r\n                      </span>\r\n                    </label>\r\n                  </li>\r\n                </ul>\r\n              </fieldset>\r\n\r\n              <fieldset class=\"form__block\">\r\n                <legend class=\"form__legend\">Размер</legend>\r\n                <label class=\"form__label form__label--small form__label--select\">\r\n                  <select class=\"form__select\" type=\"text\" name=\"category\" v-model=\"activeSizeId\">\r\n                    <option :value=\"size.id\" v-for=\"size in product.sizes\" :key=\"size.id\">{{ size.title }}</option>\r\n                  </select>\r\n                </label>\r\n              </fieldset>\r\n            </div>\r\n            \r\n            <button class=\"item__button button button--primery\" type=\"submit\" :disabled=\"isSending\" @click.prevent=\"addToCart\">\r\n              В корзину\r\n            </button>\r\n            <p v-if=\"isSending\">Добавляем товар в корзину...</p>\r\n            <p v-if=\"isSendingFailed\">Произошла ошибка при добавлении товара в корзину. Попробуйте ещё раз!</p>\r\n            <p v-else-if=\"isAdded\">Товар успешно добавлен в корзину!</p>\r\n          </form>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"item__desc\">\r\n        <ul class=\"tabs\">\r\n          <li class=\"tabs__item\">\r\n            <a class=\"tabs__link\" :class=\"{'tabs__link--current': selectedTab === 'base-item-content'}\" @click=\"setSelectedComponent('base-item-content')\">\r\n              Информация о товаре\r\n            </a>\r\n          </li>\r\n          <li class=\"tabs__item\">\r\n            <a class=\"tabs__link\" :class=\"{'tabs__link--current': selectedTab === 'base-item-delivery'}\" @click=\"setSelectedComponent('base-item-delivery')\">\r\n              Доставка и возврат\r\n            </a>\r\n          </li>\r\n        </ul>\r\n        \r\n        <component :is=\"selectedTab\"></component>\r\n      </div>\r\n    </section>\r\n  </main> \r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport { API_URL } from '@/config.js';\r\nimport BaseItemCounter from '@/components/BaseItemCounter.vue';\r\nimport BaseItemContent from '@/components/BaseItemContent.vue';\r\nimport BaseItemDelivery from '@/components/BaseItemDelivery.vue';\r\n\r\nexport default {\r\n  components: { BaseItemCounter, BaseItemContent, BaseItemDelivery },\r\n  data() {\r\n    return {\r\n      productAmount: 1,\r\n      isLoading: false,\r\n      isLoadingFailed: false,\r\n      isSending: false,\r\n      isSendingFailed: false,\r\n      isAdded: false,\r\n      productData: null,\r\n      activeColorIdx: 0,\r\n      activeSizeIdx: 0,\r\n      selectedTab: 'base-item-content',\r\n    }\r\n  },\r\n  computed: {\r\n    product() {\r\n      return {\r\n        ...this.productData,\r\n        gallery: this.productData.colors.map(color => {\r\n          return {\r\n            id: color.color.id,\r\n            image: color.gallery ? color.gallery[0].file.url : 'https://westsiderc.org/wp-content/uploads/2019/08/Image-Not-Available.png'\r\n          }\r\n        })\r\n      };\r\n    },\r\n    gallery() {\r\n      return this.product.gallery;\r\n    },\r\n    activeColorId: {\r\n      get() {\r\n        return this.gallery[this.activeColorIdx].id;\r\n      },\r\n      set(id) {\r\n        const idx = this.gallery.findIndex((item) => item.id === id);\r\n        this.activeColorIdx = idx;\r\n      }\r\n    },\r\n    activeSizeId: {\r\n      get() {\r\n        return this.product.sizes[this.activeSizeIdx].id;\r\n      },\r\n      set(id) {\r\n        const idx = this.product.sizes.findIndex((item) => item.id === id);\r\n        this.activeSizeIdx = idx;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    async loadProduct() {\r\n      this.isLoading = true;\r\n      this.isLoadingFailed = false;\r\n      try {\r\n        const { data } = await axios.get(`${API_URL}/products/${this.$route.params.id}`);\r\n        console.log(data);\r\n        this.productData = data;\r\n      } catch(err) {\r\n        this.isLoading = false;\r\n        this.isLoadingFailed = true;\r\n      }\r\n      this.isLoading = false;\r\n    },\r\n    setItemAmount(val) {\r\n      this.productAmount = val;\r\n    },\r\n    changeImg(id) {\r\n      const idx = this.gallery.findIndex((item) => item.id === id);\r\n      this.activeColorIdx = idx;\r\n    },\r\n    async addToCart() {\r\n      this.isSending = true;\r\n      this.isAdded = false;\r\n      this.isSendingFailed = false;\r\n      try {\r\n        await this.$store.dispatch('addToCart', {\r\n          productId: this.product.id,\r\n          colorId: this.activeColorId,\r\n          sizeId: this.activeSizeId,\r\n          quantity: this.productAmount\r\n        });\r\n      } catch(err) {\r\n        this.isSendingFailed = true;\r\n      }\r\n      this.isSending = false;\r\n      this.isAdded = true;\r\n    },\r\n    setSelectedComponent(val) {\r\n      this.selectedTab = val;\r\n    }\r\n  },\r\n  created() {\r\n    this.loadProduct();\r\n  }\r\n}\r\n</script>"]},"metadata":{},"sourceType":"module"}